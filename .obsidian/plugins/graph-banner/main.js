var W=Object.create;var u=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var j=Object.getOwnPropertyNames;var K=Object.getPrototypeOf,U=Object.prototype.hasOwnProperty;var z=(s,e,t)=>e in s?u(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var Y=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports),q=(s,e)=>{for(var t in e)u(s,t,{get:e[t],enumerable:!0})},$=(s,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of j(e))!U.call(s,n)&&n!==t&&u(s,n,{get:()=>e[n],enumerable:!(i=M(e,n))||i.enumerable});return s};var J=(s,e,t)=>(t=s!=null?W(K(s)):{},$(e||!s||!s.__esModule?u(t,"default",{value:s,enumerable:!0}):t,s)),Q=s=>$(u({},"__esModule",{value:!0}),s);var h=(s,e,t)=>z(s,typeof e!="symbol"?e+"":e,t);var c=(s,e,t)=>new Promise((i,n)=>{var r=o=>{try{g(t.next(o))}catch(l){n(l)}},a=o=>{try{g(t.throw(o))}catch(l){n(l)}},g=o=>o.done?i(o.value):Promise.resolve(o.value).then(r,a);g((t=t.apply(s,e)).next())});var B=Y((ye,V)=>{function k(s){return Array.isArray(s)?s:[s]}var Z=void 0,L="",b=" ",C="\\",ee=/^\s+$/,te=/(?:[^\\]|^)\\$/,se=/^\\!/,ie=/^\\#/,ne=/\r?\n/g,re=/^\.*\/|^\.+$/,ae=/\/$/,f="/",D="node-ignore";typeof Symbol!="undefined"&&(D=Symbol.for("node-ignore"));var O=D,_=(s,e,t)=>(Object.defineProperty(s,e,{value:t}),t),oe=/([0-z])-([0-z])/g,F=()=>!1,ce=s=>s.replace(oe,(e,t,i)=>t.charCodeAt(0)<=i.charCodeAt(0)?e:L),he=s=>{let{length:e}=s;return s.slice(0,e-e%2)},le=[[/^\uFEFF/,()=>L],[/((?:\\\\)*?)(\\?\s+)$/,(s,e,t)=>e+(t.indexOf("\\")===0?b:L)],[/(\\+?)\s/g,(s,e)=>{let{length:t}=e;return e.slice(0,t-t%2)+b}],[/[\\$.|*+(){^]/g,s=>`\\${s}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(s,e,t)=>e+6<t.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(s,e,t)=>{let i=t.replace(/\\\*/g,"[^\\/]*");return e+i}],[/\\\\\\(?=[$.|*+(){^])/g,()=>C],[/\\\\/g,()=>C],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(s,e,t,i,n)=>e===C?`\\[${t}${he(i)}${n}`:n==="]"&&i.length%2===0?`[${ce(t)}${i}]`:"[]"],[/(?:[^*])$/,s=>/\/$/.test(s)?`${s}$`:`${s}(?=$|\\/$)`]],pe=/(^|\\\/)?\\\*$/,E="regex",A="checkRegex",I="_",ge={[E](s,e){return`${e?`${e}[^/]+`:"[^/]*"}(?=$|\\/$)`},[A](s,e){return`${e?`${e}[^/]*`:"[^/]*"}(?=$|\\/$)`}},de=s=>le.reduce((e,[t,i])=>e.replace(t,i.bind(s)),s),R=s=>typeof s=="string",fe=s=>s&&R(s)&&!ee.test(s)&&!te.test(s)&&s.indexOf("#")!==0,ue=s=>s.split(ne).filter(Boolean),P=class{constructor(e,t,i,n,r,a){this.pattern=e,this.mark=t,this.negative=r,_(this,"body",i),_(this,"ignoreCase",n),_(this,"regexPrefix",a)}get regex(){let e=I+E;return this[e]?this[e]:this._make(E,e)}get checkRegex(){let e=I+A;return this[e]?this[e]:this._make(A,e)}_make(e,t){let i=this.regexPrefix.replace(pe,ge[e]),n=this.ignoreCase?new RegExp(i,"i"):new RegExp(i);return _(this,t,n)}},_e=({pattern:s,mark:e},t)=>{let i=!1,n=s;n.indexOf("!")===0&&(i=!0,n=n.substr(1)),n=n.replace(se,"!").replace(ie,"#");let r=de(n);return new P(s,e,n,t,i,r)},S=class{constructor(e){this._ignoreCase=e,this._rules=[]}_add(e){if(e&&e[O]){this._rules=this._rules.concat(e._rules._rules),this._added=!0;return}if(R(e)&&(e={pattern:e}),fe(e.pattern)){let t=_e(e,this._ignoreCase);this._added=!0,this._rules.push(t)}}add(e){return this._added=!1,k(R(e)?ue(e):e).forEach(this._add,this),this._added}test(e,t,i){let n=!1,r=!1,a;this._rules.forEach(o=>{let{negative:l}=o;r===l&&n!==r||l&&!n&&!r&&!t||!o[i].test(e)||(n=!l,r=l,a=l?Z:o)});let g={ignored:n,unignored:r};return a&&(g.rule=a),g}},Ee=(s,e)=>{throw new e(s)},p=(s,e,t)=>R(s)?s?p.isNotRelative(s)?t(`path should be a \`path.relative()\`d string, but got "${e}"`,RangeError):!0:t("path must not be empty",TypeError):t(`path must be a string, but got \`${e}\``,TypeError),X=s=>re.test(s);p.isNotRelative=X;p.convert=s=>s;var G=class{constructor({ignorecase:e=!0,ignoreCase:t=e,allowRelativePaths:i=!1}={}){_(this,O,!0),this._rules=new S(t),this._strictPathCheck=!i,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}add(e){return this._rules.add(e)&&this._initCache(),this}addPattern(e){return this.add(e)}_test(e,t,i,n){let r=e&&p.convert(e);return p(r,e,this._strictPathCheck?Ee:F),this._t(r,t,i,n)}checkIgnore(e){if(!ae.test(e))return this.test(e);let t=e.split(f).filter(Boolean);if(t.pop(),t.length){let i=this._t(t.join(f)+f,this._testCache,!0,t);if(i.ignored)return i}return this._rules.test(e,!1,A)}_t(e,t,i,n){if(e in t)return t[e];if(n||(n=e.split(f).filter(Boolean)),n.pop(),!n.length)return t[e]=this._rules.test(e,i,E);let r=this._t(n.join(f)+f,t,i,n);return t[e]=r.ignored?r:this._rules.test(e,i,E)}ignores(e){return this._test(e,this._ignoreCache,!1).ignored}createFilter(){return e=>!this.ignores(e)}filter(e){return k(e).filter(this.createFilter())}test(e){return this._test(e,this._testCache,!0)}},N=s=>new G(s),me=s=>p(s&&p.convert(s),s,F);if(typeof process!="undefined"&&(process.env&&process.env.IGNORE_TEST_WIN32||process.platform==="win32")){let s=t=>/^\\\\\?\\/.test(t)||/["<>|\u0000-\u001F]+/u.test(t)?t:t.replace(/\\/g,"/");p.convert=s;let e=/^[a-z]:\//i;p.isNotRelative=t=>e.test(t)||X(t)}V.exports=N;N.default=N;V.exports.isPathValid=me});var we={};q(we,{default:()=>v});module.exports=Q(we);var H=J(B()),w=require("obsidian");var d=require("obsidian");var x={ignore:[],timeToRemoveLeaf:100},y=class extends d.PluginSettingTab{constructor(t,i){super(t,i);h(this,"plugin");this.plugin=i}display(){let{containerEl:t}=this;t.empty(),new d.Setting(t).setName("Ignored Path Pattern").setDesc("Manage notes which do not display the graph banner. This pattern follows .gitignore spec.").addTextArea(i=>i.setPlaceholder(`ignored-path.md
/ignored-dir
!/ignored-dir/not-ignored-path.md`).setValue(this.plugin.settings.ignore.join(`
`)).onChange(n=>c(this,null,function*(){this.plugin.settings.ignore=n.split(`
`),yield this.plugin.saveData(this.plugin.settings)}))),new d.Setting(t).setName("Advanced: Time [ms] to remove the graph leaf for the banner").setDesc(`This plugin temporarily create a local graph leaf to display in the banner of the notes.
If you want to do something when the local graph opened, for example by using the "Sync Graph Settings" plugin, set this time settings.
If set to 0ms, the leaf is immediately erased.
To reflect this setting, please reload the app.`).addText(i=>i.setPlaceholder("500").setValue(String(this.plugin.settings.timeToRemoveLeaf)).onChange(n=>c(this,null,function*(){let r=Number(n);(n===""||Number.isNaN(r)||r<0)&&new d.Notice("Please specify a valid number."),this.plugin.settings.timeToRemoveLeaf=r,yield this.plugin.saveData(this.plugin.settings)})))}};var m=class m{constructor(e,t){h(this,"leaf");h(this,"node");h(this,"setupLeafPromise");var n;this.leaf=e.workspace.getLeaf("tab"),this.setupLeafPromise=this.setupLeaf(t.settings.timeToRemoveLeaf);let i=this.leaf.view.containerEl.find(".view-content");i.addClass(m.nodeClass),(n=i.find(".graph-controls"))==null||n.toggleClass("is-close",!0),this.node=i}setupLeaf(e){return c(this,null,function*(){yield this.leaf.setViewState({type:"localgraph"});let t=()=>this.leaf.parent.removeChild(this.leaf);e>0?setTimeout(t,e):t()})}placeTo(e){return c(this,null,function*(){yield this.setupLeafPromise,yield this.leaf.setViewState({type:"localgraph",state:{file:e.file.path}}),this.leaf.setGroup(e.file.path);let t=e.containerEl.find(".inline-title"),i=t.parentElement;if(!i)throw"Failed to get note header";i.insertAfter(this.node,t)})}isDescendantOf(e){return e.contains(this.node)}setVisibility(e){this.node.toggleClass("hidden",!e)}detach(){this.leaf.detach(),this.node.removeClass(m.nodeClass)}};h(m,"nodeClass","graph-banner-content");var T=m;var v=class extends w.Plugin{constructor(){super(...arguments);h(this,"settings",x);h(this,"graphViews",[])}onload(){return c(this,null,function*(){yield this.loadSettings(),this.addSettingTab(new y(this.app,this)),this.app.workspace.trigger("parse-style-settings"),this.registerEvent(this.app.workspace.on("file-open",i=>c(this,null,function*(){if(!i||i.extension!=="md")return;let n=this.app.workspace.getActiveViewOfType(w.MarkdownView);!n||n.file!==i||(yield this.placeGraphView(n))}))),this.registerEvent(this.app.workspace.on("layout-change",()=>c(this,null,function*(){let i=this.app.workspace.getActiveViewOfType(w.MarkdownView);i&&(yield this.placeGraphView(i))})));let t=this.app.workspace.getLeavesOfType("markdown");for(let i of t)this.placeGraphView(i.view)})}onunload(){console.log("Unloading GraphBannerPlugin");for(let t of this.graphViews)t.detach();this.graphViews=[]}loadSettings(){return c(this,null,function*(){this.settings=Object.assign({},x,yield this.loadData())})}placeGraphView(t){return c(this,null,function*(){let i=(0,H.default)().add(this.settings.ignore).ignores(t.file.path),n=this.findAvailableGraphView(t);n.setVisibility(!i),yield n.placeTo(t)})}findAvailableGraphView(t){console.debug("this.graphViews.length",this.graphViews.length);let i=this.graphViews.find(a=>a.isDescendantOf(t.containerEl));if(i!==void 0)return i;let n=this.app.workspace.getLeavesOfType("markdown").map(a=>a.view.containerEl);for(let a of this.graphViews)if(!n.some(o=>a.isDescendantOf(o)))return a;let r=new T(this.app,this);return this.graphViews.push(r),r}};

/* nosourcemap */